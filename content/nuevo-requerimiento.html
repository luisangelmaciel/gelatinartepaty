<link rel="stylesheet" href="https://preline.co/assets/css/main.min.css?v=2.3.0">
<!-- Theme Check and Update -->
<script>
 const html = document.querySelector('html');
 const isLightOrAuto = localStorage.getItem('hs_theme') === 'light' || (localStorage.getItem('hs_theme') === 'auto' && !window.matchMedia('(prefers-color-scheme: dark)').matches);
 const isDarkOrAuto = localStorage.getItem('hs_theme') === 'dark' || (localStorage.getItem('hs_theme') === 'auto' && window.matchMedia('(prefers-color-scheme: dark)').matches);
 if (isLightOrAuto && html.classList.contains('dark')) html.classList.remove('dark');
 else if (isDarkOrAuto && html.classList.contains('light')) html.classList.remove('light');
 else if (isDarkOrAuto && !html.classList.contains('dark')) html.classList.add('dark');
 else if (isLightOrAuto && !html.classList.contains('light')) html.classList.add('light');
</script>
<!-- Apexcharts -->
<link rel="stylesheet" href="https://preline.co//assets/vendor/apexcharts/dist/apexcharts.css">
<div class="max-w-[85rem] px-4 py-10 sm:px-6 lg:px-8 lg:py-14 mx-auto">
 <div class="mt-5 p-4 relative z-10 bg-white border rounded-xl sm:mt-10 md:p-10 dark:bg-neutral-900 dark:border-neutral-700">
  <style>
   .hidden {
    display: none;
   }

   #thankyou-message {
    /*  margin-top: 20px;
   padding: 10px;
   background-color: #e6f7ff;
   border: 1px solid #91d5ff;
   border-radius: 4px;*/
   }
  </style>
  <form id="gform" method="POST" action="https://script.google.com/macros/s/AKfycbxTGK4gTASuWPs8s9LXAssHPcgWl9vdA0p-f5XthELqmYwbx2ZCu-r5HkqoljPMG9LOnw/exec">
   <input type="hidden" id="emailSubject" name="emailSubject" value="⚠️ Nuevo requerimiento">
   <div class="mb-4 sm:mb-8">
    <label for="Solicitud" class="block mb-2 text-sm font-medium dark:text-white">Solicitud</label>
    <input type="text" id="hs-feedback-post-comment-name-1" class="py-3 px-4 block w-full border-gray-200 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400 dark:placeholder-neutral-500 dark:focus:ring-neutral-600" placeholder="" id="Solicitud" name="Solicitud">
   </div>

   <div>
    <label for="Requerimiento" class="block mb-2 text-sm font-medium dark:text-white">Explicar requerimiento</label>
    <div class="mt-1">
     <textarea id="Requerimiento" name="Requerimiento" rows="3" class="py-3 px-4 block w-full border-gray-200 rounded-lg text-sm focus:border-blue-500 focus:ring-blue-500 disabled:opacity-50 disabled:pointer-events-none dark:bg-neutral-900 dark:border-neutral-700 dark:text-neutral-400 dark:placeholder-neutral-500 dark:focus:ring-neutral-600" placeholder="Por favor exploque los detalles"></textarea>
    </div>
   </div>

   <div class="mt-6 grid">
    <button id="submit-button" type="submit" class="w-full py-3 px-4 inline-flex justify-center items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none">
     <span id="button-text">Solicitar nuevo requerimiento</span>
     <span id="wait-message" class="hidden">Espere un momento, por favor...</span>
    </button>
   </div>
  </form>
  <div class="mt-6 grid">
   <div id="thankyou-message" class="hidden"> <a href="javascript:history.back()" class="w-full py-3 px-4 inline-flex justify-center items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none"> En 15 minutos apareceran los detalles de la solicitud
    </a></div>
  </div>

  <script data-cfasync="false" type="text/javascript">
   document.addEventListener("DOMContentLoaded", function() {
    const form = document.getElementById('gform');
    const submitButton = document.getElementById('submit-button');
    const buttonText = document.getElementById('button-text');
    const waitMessage = document.getElementById('wait-message');
    const thankYouMessage = document.getElementById('thankyou-message');
    form.addEventListener("submit", handleFormSubmit);

    function handleFormSubmit(event) {
     event.preventDefault();
     const data = getFormData(form);
     localStorage.setItem('formData', JSON.stringify(data));
     setSubmitting(true);
     const xhr = new XMLHttpRequest();
     xhr.open('POST', form.action);
     xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
     xhr.onreadystatechange = function() {
      if (xhr.readyState === 4) {
       console.log(xhr.status, xhr.statusText);
       console.log(xhr.responseText);
       setSubmitting(false);
       showThankYouMessage();
      }
     };
     const encoded = Object.keys(data).map(k =>
      encodeURIComponent(k) + "=" + encodeURIComponent(data[k])
     ).join('&');
     xhr.send(encoded);
    }

    function setSubmitting(isSubmitting) {
     submitButton.disabled = isSubmitting;
     buttonText.classList.toggle('hidden', isSubmitting);
     waitMessage.classList.toggle('hidden', !isSubmitting);
    }

    function showThankYouMessage() {
     thankYouMessage.classList.remove('hidden');
     // El mensaje de agradecimiento permanecerá visible
    }

    function getFormData(form) {
     const elements = form.elements;
     const fields = Object.keys(elements).filter(k =>
      elements[k].name !== "honeypot"
     ).map(k =>
      elements[k].name !== undefined ? elements[k].name :
      elements[k].length > 0 ? elements[k].item(0).name : null
     ).filter((item, pos, self) =>
      item && self.indexOf(item) == pos
     );
     const formData = {};
     fields.forEach(name => {
      const element = elements[name];
      formData[name] = element.value;
      if (element.length) {
       formData[name] = Array.from(element)
        .filter(item => item.checked || item.selected)
        .map(item => item.value)
        .join(', ');
      }
     });
     formData.formDataNameOrder = JSON.stringify(fields);
     formData.formGoogleSheetName = form.dataset.sheet || "Accesos";
     formData.formGoogleSendEmail = form.dataset.email || "luis.el.de.las.tarjetas@gmail.com";
     formData.emailSubject = form.querySelector('#emailSubject').value || "";
     return formData;
    }
   });
  </script>
 </div><br><br><br><br><br><br>
 <button class="w-full py-3 px-4 inline-flex justify-center items-center gap-x-2 text-sm font-semibold rounded-lg border border-transparent bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 disabled:pointer-events-none" onclick="history.back()" style="background-color:black">
  Regresar
 </button>
</div>